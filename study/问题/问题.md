## IDEA配置svn

1、打开setting-->version Control--> subverion 配置svn客户端路径

![image-20230524105840165](assets/image-20230524105840165.png)

2、选择版本工具为svn

![image-20230524110240573](assets/image-20230524110240573.png)

![image-20230524110329892](assets/image-20230524110329892.png)

3、查看svn仓库

![image-20230524110700172](assets/image-20230524110700172.png)

4、添加svn地址

![image-20230524110748088](assets/image-20230524110748088.png)

5、上传到svn

![image-20230524111044908](assets/image-20230524111044908.png)

![image-20230524111112155](assets/image-20230524111112155.png)

![image-20230524111130584](assets/image-20230524111130584.png)

6、再次右键提交工程

![image-20230524111233958](assets/image-20230524111233958.png)

7、检查下是否过滤成功，提交即可



## IDEA设置SVN提交忽略文件

1、在setting-->editor-->file types -->Ignore files and folders中填写你需要忽略的文件或文件夹

![image-20230524111610601](assets/image-20230524111610601.png)

2、新增过滤的条件

```
node_modules;target;.idea;.settings;.project;*.iml;*.log;.logs;.classpath;.factorypath;.gitee;.github;
```

3、在svn客户端TortoriseSVN进行设置

![image-20230524111816908](assets/image-20230524111816908.png)

添加如下条件，覆盖即可

```
*node_modules *target *.iml *.gitee *.github *.svn *.idea  *.o *.lo *.la *.al .libs *.so *.so.[0-9]* *.a *.pyc *.pyo __pycache__ *.rej *~ #*# .#* .*.swp .DS_Store [Tt]humbs.db
```

## 解决springboot无法加载到nacos中的数据源问题

异常现象

正常配置，却出现了无数据源的问题

![image-20230524163852967](assets/image-20230524163852967.png)

异常原因

**从Spring Boot 2.4版本开始，配置文件加载方式进行了重构，这才导致读取不到nacos配置中心文件的问题**

解决方法

增加依赖

```
<!-- 版本跟nacos保持一致 -->
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-bootstrap</artifactId>
</dependency>
```

## IDEA配置热部署

1、添加依赖

```xml
 <dependency>
  <groupId>org.springframework.boot</groupId>
  <artifactId>spring-boot-devtools</artifactId>
 </dependency>
```

2、添加插件

```xml
			<plugin>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-maven-plugin</artifactId>
				<configuration>
					<fork>true</fork>
					<addResources>true</addResources>
				</configuration>
			</plugin>
```

3、开启自动编译

File-Settings-Compiler-Build Project automatically

![image-20230526152927085](assets/image-20230526152927085.png)

4、Ctrl+Shift+Alt+/ 选择Registry

![image-20230526150016199](assets/image-20230526150016199.png)



**找到选项Compiler autoMake allow when app running打勾**

**注意IDEA2022版本 在registry中找不到这选项，需要在Advanced Settings中开启**

![image-20230526150527243](assets/image-20230526150527243.png)

5、设置项目加载方式

**找到spring boot下的 On ‘Update' action 和 On frame deactivation** **，选择 Update classes and resources**

![image-20230526150846436](assets/image-20230526150846436.png)

![image-20230526151327240](assets/image-20230526151327240.png)

![image-20230526151154101](assets/image-20230526151154101.png)

![image-20230526151626757](assets/image-20230526151626757.png)

6、测试热部署是否生效

修改一个文件之后，看看是否生效

## 数据库字段有下划线导致获取值为null

问题原因：

mybatis plus 默认开启了驼峰命名规则，导致获取不到相关值

解决方法：

关闭mybatis plus 驼峰命名规则

```yml
mybatis-plus:
  configuration:
    map-underscore-to-camel-case: false # 关闭驼峰命名规则
```

## gateway报错class path resource [org/springframework/web/servlet/mvc/method/annotation/ResponseBodyAdvice

**出现原因**

> `gateway`引入了自定义的common包里面定义了统一返回值处理的方法
>
> 因为`gateway`不能使用`web-starter`所以报`ResponseBodyAdvice找不到`这个错误

```
@RestControllerAdvice(basePackages = "com.hy.demo")
public class ResponseAdvice implements ResponseBodyAdvice<Object> {
}
```

**解决方法**

>添加`@ConditionalOnClass`注解

```java
@RestControllerAdvice(basePackages = "com.hy.demo")
@ConditionalOnClass(ResponseBodyAdvice.class)
public class ResponseAdvice implements ResponseBodyAdvice<Object> {
}
```

## knife4j3.0文件上传接口没有上传文本域

**关键点**

> 文件要使用@RequestPart注解，dataType要使用MultipartFile，dataTypeClass要使用MultipartFile.class，paramType使用query
>
> allowMultiple = true 允许多文件上传

```java
 @ApiImplicitParams({@ApiImplicitParam(name = "file", value = "文件流对象", required = true,paramType = "query",dataType = "MultipartFile",allowMultiple = false,dataTypeClass = MultipartFile.class),
            @ApiImplicitParam(name = "proid", value = "proid", required = true,dataType = "String",dataTypeClass = String.class)})
    public CommonResult upload(@RequestPart("file") MultipartFile file, @RequestParam("proid") String proid, HttpServletRequest request) throws IOException {
    }
```

## bootstrap.yml配置文件不生效

**问题原因**

> 从springboot2.4版本开始，配置文件的方式进行了重构

```java
package org.springframework.cloud.util;
public abstract class PropertyUtils {
    public static boolean bootstrapEnabled(Environment environment) {
        return (Boolean)environment.getProperty("spring.cloud.bootstrap.enabled", Boolean.class, false) || MARKER_CLASS_EXISTS;
    }
```

**解决方案**

```xml
<!-- 引入bootstrap -->
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-bootstrap</artifactId>
</dependency>
```

## 通过spring gateway访问其他服务503 service unavailable

**问题原因**

> Spring Cloud 2020.0.0版本之前会自动引入Netflix Ribbon依赖,Netflix Ribbon功能跟loadbalancer一样,因Netflix公司停止维护Ribbon后, 在Spring Cloud 2020.0.0版本之后Spring使用loadbalancer替代了Ribbon, 但是loadbalancer依赖需要手动引入

**解决方案**

```xml
# 引入loadbalancer
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-loadbalancer</artifactId>
</dependency>
```

**后续问题**

> 增加loadbalancer后启动提示：Spring Cloud LoadBalancer is currently working with the default cache. You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath

**解决方案**

> 解决方案是引入caffeine，或者关闭cache

```xml
<dependency>
    <groupId>com.github.ben-manes.caffeine</groupId>
    <artifactId>caffeine</artifactId>
    <version>2.9.3</version>
</dependency>
```

**后续问题**

> 访问其他服务时提示：LoadBalancerCacheManager not available, returning delegate without caching

**解决方案**

> 引入以下依赖

```xml
<dependency>
  <groupId>org.springframework</groupId>
  <artifactId>spring-context-support</artifactId>
  <version>5.2.21.RELEASE</version>
</dependency>
```

## Failed to start bean ‘documentationPluginsBootstrapper’; nested exception is java.lang.NullPointerException

**问题原因**

> SpringBoot2.6之后将SpringMVC 默认路径匹配策略从AntPathMatcher 更改为PathPatternParser，导致出错

**解决方案**

> 添加配置

```yaml
spring:
  mvc:
    pathmatch:
      matching-strategy: ant_path_matcher
```

